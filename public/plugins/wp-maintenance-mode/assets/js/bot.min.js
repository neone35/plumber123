"use strict";function getCurrentTime(){var n=new Date,t=n.getHours(),e=n.getMinutes(),r=t>=12?"PM":"AM";return t%=12,t=t||12,e=e<10?"0"+e:e,t+":"+e+" "+r}function renderStatement(n){jQuery(".chat-container").append('<div class="chat-message-wrapper"><div class="absolute-wrapper"><div class="message-details"><div class="bot-avatar"></div><span class="message-date">'+getCurrentTime()+'</span></div></div><p class="chat-message">'+n+"</p></div>")}function showTyping(){jQuery(".chat-container").append('<div class="typing-wrapper"><div class="bot-avatar"></div><span class="bot-name">'+botName+'</span><p class="chat-message typing"><span class="dot"></span><span class="dot"></span><span class="dot"></span></p></div>')}function hideTyping(){jQuery(".typing-wrapper").remove()}function scrollToBottom(){chatWrapper.animate({scrollTop:600},"slow")}function inputError(n){jQuery(".bot-error p").text(n),jQuery(".bot-error").animate({bottom:0},500).delay(3e3).animate({bottom:"-70px"},500)}function checkInput(n){return jQuery(".bot-container input[type=text]").val().length>2?showResponse(n):inputError(botVars.validationName),!1}function checkEmail(n){var t=jQuery(".bot-container input[type=email]").val(),e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,r=e.test(String(t.toLowerCase()));if(t.length>7&&!0===r){var i=jQuery(".bot-container input[type=email]").serialize(),o="action=wpmm_add_subscriber&"+i;jQuery.post(wpmm_vars.ajax_url,o,function(n){if(!n.success)return alert(n.data),!1},"json"),showResponse(n)}else inputError(botVars.validationEmail);return!1}function clearChat(){jQuery(".chat-container").empty()}function clearFooter(){jQuery(".choices").empty(),jQuery(".input").empty()}function startConversation(n,t){clearFooter(),clearChat(),conversationPos=n,jQuery.getScript(botVars.uploadsBaseUrl+"data.js",function(n){showStatement(t)})}function showStatement(n){var t=conversationData[conversationPos][n];"sideeffect"in t&&jQuery.type("function"===t.sideeffect)&&t.sideeffect(context);var e;"array"===jQuery.type(t.statement)?e=t.statement:"string"===jQuery.type(t.statement)?e=[t.statement]:"function"===jQuery.type(t.statement)&&(e=t.statement(context)),async.eachSeries(e,function(n,t){if(showTyping(),scrollToBottom(),n.length<=50)var e=1800;else var e=n.length/3*30*(Math.floor(5*Math.random())+1.2);DEBUG&&(e=0),setTimeout(function(){hideTyping(),renderStatement(n),scrollToBottom(),t()},e)},function(n){if("options"in t){jQuery(".input").hide(),jQuery(".choices").show();var e=t.options;e.length>0&&setTimeout(function(){for(var n=0;n<e.length;n++){var t=e[n],r,i;null===t.consequence?(i=null,r="disabled"):(i=function(n){showResponse(n)}.bind(null,t),r="");var o=jQuery("<p/>",{text:t.choice,class:"chat-message user",click:i}).appendTo(".choices")}},750)}else if("input"in t){jQuery(".input").show(),jQuery(".choices").hide();var r=t.input,i=jQuery("<form/>",{submit:checkInput.bind(null,r)}),o=jQuery("<p/>",{class:"chat-message user"}).appendTo(i),u=jQuery("<input/>",{type:"text",placeholder:botVars.typeName,name:r.name,autocomplete:"off",required:!0}).appendTo(o),c=jQuery("<a/>",{text:"Send",click:checkInput.bind(null,r)}).appendTo(o);i.appendTo(".input"),async.nextTick(function(){u.focus()})}else if("email"in t){jQuery(".input").show(),jQuery(".choices").hide();var r=t.email,i=jQuery("<form/>",{class:"bot_subscribe_form",submit:checkEmail.bind(null,r)}),o=jQuery("<p/>",{class:"chat-message user"}).appendTo(i),u=jQuery("<input/>",{type:"email",placeholder:botVars.typeEmail,name:r.email,autocomplete:"off"}).appendTo(o),c=jQuery("<a/>",{text:botVars.send,click:checkEmail.bind(null,r)}).appendTo(o);i.appendTo(".input"),async.nextTick(function(){u.focus()})}scrollToBottom()})}function showResponse(n){var t="";"name"in n?(context[n.name]=jQuery(".bot-container input[type=text]").val(),t=context[n.name]):"email"in n?(context[n.email]=jQuery(".bot-container input[type=email]").val(),t=context[n.email]):t=n.choice,clearFooter(),jQuery(".chat-container").append('<p class="chat-message user">'+t+"</p>"),"consequence"in n&&showStatement(n.consequence)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(){function n(){}function t(n){return n}function e(n){return!!n}function r(n){return!n}function i(n){return function(){if(null===n)throw new Error("Callback was already called.");n.apply(this,arguments),n=null}}function o(n){return function(){null!==n&&(n.apply(this,arguments),n=null)}}function u(n){return M(n)||"number"==typeof n.length&&n.length>=0&&n.length%1==0}function c(n,t){return u(n)?a(n,t):p(n,t)}function a(n,t){for(var e=-1,r=n.length;++e<r;)t(n[e],e,n)}function s(n,t){for(var e=-1,r=n.length,i=Array(r);++e<r;)i[e]=t(n[e],e,n);return i}function l(n){return s(Array(n),function(n,t){return t})}function f(n,t,e){return a(n,function(n,r,i){e=t(e,n,r,i)}),e}function p(n,t){a(P(n),function(e){t(n[e],e)})}function h(n,t){for(var e=0;e<n.length;e++)if(n[e]===t)return e;return-1}function y(n){var t=-1,e,r;return u(n)?(e=n.length,function n(){return t++,t<e?t:null}):(r=P(n),e=r.length,function n(){return t++,t<e?r[t]:null})}function m(n,t){return t=null==t?n.length-1:+t,function(){for(var e=Math.max(arguments.length-t,0),r=Array(e),i=0;i<e;i++)r[i]=arguments[i+t];switch(t){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r);case 2:return n.call(this,arguments[0],arguments[1],r)}}}function d(n){return function(t,e,r){return n(t,r)}}function v(t){return function(e,r,u){u=o(u||n),e=e||[];var c=y(e);if(t<=0)return u(null);var a=!1,s=0,l=!1;!function n(){if(a&&s<=0)return u(null);for(;s<t&&!l;){var o=c();if(null===o)return a=!0,void(s<=0&&u(null));s+=1,r(e[o],o,i(function(t){s-=1,t?(u(t),l=!0):n()}))}}()}}function g(n){return function(t,e,r){return n(C.eachOf,t,e,r)}}function b(n){return function(t,e,r,i){return n(v(e),t,r,i)}}function k(n){return function(t,e,r){return n(C.eachOfSeries,t,e,r)}}function j(t,e,r,i){i=o(i||n);var u=[];t(e,function(n,t,e){r(n,function(n,r){u[t]=r,e(n)})},function(n){i(n,u)})}function w(n,t,e,r){var i=[];n(t,function(n,t,r){e(n,function(e){e&&i.push({index:t,value:n}),r()})},function(){r(s(i.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function Q(n,t,e,r){w(n,t,function(n,t){e(n,function(n){t(!n)})},r)}function x(n,t,e){return function(r,i,o,u){function c(){u&&u(e(!1,void 0))}function a(n,r,i){if(!u)return i();o(n,function(r){u&&t(r)&&(u(e(!0,n)),u=o=!1),i()})}arguments.length>3?n(r,i,a,c):(u=o,o=i,n(r,a,c))}}function S(n,t){return t}function T(t,e,r){r=r||n;var i=u(e)?[]:{};t(e,function(n,t,e){n(m(function(n,r){r.length<=1&&(r=r[0]),i[t]=r,e(n)}))},function(n){r(n,i)})}function E(n,t,e,r){var i=[];n(t,function(n,t,r){e(n,function(n,t){i=i.concat(t||[]),r(n)})},function(n){r(n,i)})}function O(t,e,r){function o(t,e,r,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(t.started=!0,M(e)||(e=[e]),0===e.length&&t.idle())return C.setImmediate(function(){t.drain()});a(e,function(e){var o={data:e,callback:i||n};r?t.tasks.unshift(o):t.tasks.push(o),t.tasks.length===t.concurrency&&t.saturated()}),C.setImmediate(t.process)}function u(n,t){return function(){c-=1;var e=arguments;a(t,function(n){n.callback.apply(n,e)}),n.tasks.length+c===0&&n.drain(),n.process()}}if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var c=0,l={tasks:[],concurrency:e,payload:r,saturated:n,empty:n,drain:n,started:!1,paused:!1,push:function n(t,e){o(l,t,!1,e)},kill:function t(){l.drain=n,l.tasks=[]},unshift:function n(t,e){o(l,t,!0,e)},process:function n(){if(!l.paused&&c<l.concurrency&&l.tasks.length)for(;c<l.concurrency&&l.tasks.length;){var e=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),r=s(e,function(n){return n.data});0===l.tasks.length&&l.empty(),c+=1;var o=i(u(l,e));t(r,o)}},length:function n(){return l.tasks.length},running:function n(){return c},idle:function n(){return l.tasks.length+c===0},pause:function n(){l.paused=!0},resume:function n(){if(!1!==l.paused){l.paused=!1;for(var t=Math.min(l.concurrency,l.tasks.length),e=1;e<=t;e++)C.setImmediate(l.process)}}};return l}function I(n){return m(function(t,e){t.apply(null,e.concat([m(function(t,e){"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&a(e,function(t){console[n](t)}))})]))})}function L(n){return function(t,e,r){n(l(t),e,r)}}function _(n){return m(function(t,e){var r=m(function(e){var r=this,i=e.pop();return n(t,function(n,t,i){n.apply(r,e.concat([i]))},i)});return e.length?r.apply(this,e):r})}function A(n){return m(function(t){var e=t.pop();t.push(function(){var n=arguments;r?C.setImmediate(function(){e.apply(null,n)}):e.apply(null,n)});var r=!0;n.apply(this,t),r=!1})}var C={},q,z="object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"===("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global||this;null!=z&&(q=z.async),C.noConflict=function(){return z.async=q,C};var B=Object.prototype.toString,M=Array.isArray||function(n){return"[object Array]"===B.call(n)},P=Object.keys||function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},V="function"==typeof setImmediate&&setImmediate,D=V?function(n){V(n)}:function(n){setTimeout(n,0)};"object"===("undefined"==typeof process?"undefined":_typeof(process))&&"function"==typeof process.nextTick?C.nextTick=process.nextTick:C.nextTick=D,C.setImmediate=V?D:C.nextTick,C.forEach=C.each=function(n,t,e){return C.eachOf(n,d(t),e)},C.forEachSeries=C.eachSeries=function(n,t,e){return C.eachOfSeries(n,d(t),e)},C.forEachLimit=C.eachLimit=function(n,t,e,r){return v(t)(n,d(e),r)},C.forEachOf=C.eachOf=function(t,e,r){function a(n){n?r(n):(l+=1)>=s&&r(null)}r=o(r||n),t=t||[];var s=u(t)?t.length:P(t).length,l=0;if(!s)return r(null);c(t,function(n,r){e(t[r],r,i(a))})},C.forEachOfSeries=C.eachOfSeries=function(t,e,r){function u(){var n=!0;if(null===a)return r(null);e(t[a],a,i(function(t){if(t)r(t);else{if(null===(a=c()))return r(null);n?C.nextTick(u):u()}})),n=!1}r=o(r||n),t=t||[];var c=y(t),a=c();u()},C.forEachOfLimit=C.eachOfLimit=function(n,t,e,r){v(t)(n,e,r)},C.map=g(j),C.mapSeries=k(j),C.mapLimit=b(j),C.inject=C.foldl=C.reduce=function(n,t,e,r){C.eachOfSeries(n,function(n,r,i){e(t,n,function(n,e){t=e,i(n)})},function(n){r(n||null,t)})},C.foldr=C.reduceRight=function(n,t,e,r){var i=s(n,function(n){return n}).reverse();C.reduce(i,t,e,r)},C.select=C.filter=g(w),C.selectLimit=C.filterLimit=b(w),C.selectSeries=C.filterSeries=k(w),C.reject=g(Q),C.rejectLimit=b(Q),C.rejectSeries=k(Q),C.any=C.some=x(C.eachOf,e,t),C.someLimit=x(C.eachOfLimit,e,t),C.all=C.every=x(C.eachOf,r,r),C.everyLimit=x(C.eachOfLimit,r,r),C.detect=x(C.eachOf,t,S),C.detectSeries=x(C.eachOfSeries,t,S),C.sortBy=function(n,t,e){function r(n,t){var e=n.criteria,r=t.criteria;return e<r?-1:e>r?1:0}C.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);e(null,s(t.sort(r),function(n){return n.value}))})},C.auto=function(t,e){function r(n){y.unshift(n)}function i(n){var t=h(y,n);t>=0&&y.splice(t,1)}function u(){s--,a(y.slice(0),function(n){n()})}e=o(e||n);var c=P(t),s=c.length;if(!s)return e(null);var l={},y=[];r(function(){s||e(null,l)}),a(c,function(n){function o(){return f(y,function(n,t){return n&&l.hasOwnProperty(t)},!0)&&!l.hasOwnProperty(n)}function c(){o()&&(i(c),a[a.length-1](s,l))}for(var a=M(t[n])?t[n]:[t[n]],s=m(function(t,r){if(r.length<=1&&(r=r[0]),t){var i={};p(l,function(n,t){i[t]=n}),i[n]=r,e(t,i)}else l[n]=r,C.setImmediate(u)}),y=a.slice(0,a.length-1),d=y.length,v;d--;){if(!(v=t[y[d]]))throw new Error("Has inexistant dependency");if(M(v)&&h(v,n)>=0)throw new Error("Has cyclic dependencies")}o()?a[a.length-1](s,l):r(c)})},C.retry=function(n,t,e){function r(n,t){if("number"==typeof t)n.times=parseInt(t,10)||o;else{if("object"!==(void 0===t?"undefined":_typeof(t)))throw new Error("Unsupported argument type for 'times': "+(void 0===t?"undefined":_typeof(t)));n.times=parseInt(t.times,10)||o,n.interval=parseInt(t.interval,10)||u}}function i(n,t){function e(n,e){return function(r){n(function(n,t){r(!n||e,{err:n,result:t})},t)}}function r(n){return function(t){setTimeout(function(){t(null)},n)}}for(;a.times;){var i=!(a.times-=1);c.push(e(a.task,i)),!i&&a.interval>0&&c.push(r(a.interval))}C.series(c,function(t,e){e=e[e.length-1],(n||a.callback)(e.err,e.result)})}var o=5,u=0,c=[],a={times:o,interval:u},s=arguments.length;if(s<1||s>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return s<=2&&"function"==typeof n&&(e=t,t=n),"function"!=typeof n&&r(a,n),a.callback=e,a.task=t,a.callback?i():i},C.waterfall=function(t,e){function r(n){return m(function(t,i){if(t)e.apply(null,[t].concat(i));else{var o=n.next();o?i.push(r(o)):i.push(e),A(n).apply(null,i)}})}if(e=o(e||n),!M(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();r(C.iterator(t))()},C.parallel=function(n,t){T(C.eachOf,n,t)},C.parallelLimit=function(n,t,e){T(v(t),n,e)},C.series=function(n,t){T(C.eachOfSeries,n,t)},C.iterator=function(n){function t(e){function r(){return n.length&&n[e].apply(null,arguments),r.next()}return r.next=function(){return e<n.length-1?t(e+1):null},r}return t(0)},C.apply=m(function(n,t){return m(function(e){return n.apply(null,t.concat(e))})}),C.concat=g(E),C.concatSeries=k(E),C.whilst=function(t,e,r){if(r=r||n,t()){var i=m(function(n,o){n?r(n):t.apply(this,o)?e(i):r(null)});e(i)}else r(null)},C.doWhilst=function(n,t,e){var r=0;return C.whilst(function(){return++r<=1||t.apply(this,arguments)},n,e)},C.until=function(n,t,e){return C.whilst(function(){return!n.apply(this,arguments)},t,e)},C.doUntil=function(n,t,e){return C.doWhilst(n,function(){return!t.apply(this,arguments)},e)},C.during=function(t,e,r){r=r||n;var i=m(function(n,e){n?r(n):(e.push(o),t.apply(this,e))}),o=function n(t,o){t?r(t):o?e(i):r(null)};t(o)},C.doDuring=function(n,t,e){var r=0;C.during(function(n){r++<1?n(null,!0):t.apply(this,arguments)},n,e)},C.queue=function(n,t){return O(function(t,e){n(t[0],e)},t,1)},C.priorityQueue=function(t,e){function r(n,t){return n.priority-t.priority}function i(n,t,e){for(var r=-1,i=n.length-1;r<i;){var o=r+(i-r+1>>>1);e(t,n[o])>=0?r=o:i=o-1}return r}function o(t,e,o,u){if(null!=u&&"function"!=typeof u)throw new Error("task callback must be a function");if(t.started=!0,M(e)||(e=[e]),0===e.length)return C.setImmediate(function(){t.drain()});a(e,function(e){var c={data:e,priority:o,callback:"function"==typeof u?u:n};t.tasks.splice(i(t.tasks,c,r)+1,0,c),t.tasks.length===t.concurrency&&t.saturated(),C.setImmediate(t.process)})}var u=C.queue(t,e);return u.push=function(n,t,e){o(u,n,t,e)},delete u.unshift,u},C.cargo=function(n,t){return O(n,1,t)},C.log=I("log"),C.dir=I("dir"),C.memoize=function(n,t){var e={},r={};t=t||function(n){return n};var i=m(function i(o){var u=o.pop(),c=t.apply(null,o);c in e?C.nextTick(function(){u.apply(null,e[c])}):c in r?r[c].push(u):(r[c]=[u],n.apply(null,o.concat([m(function(n){e[c]=n;var t=r[c];delete r[c];for(var i=0,o=t.length;i<o;i++)t[i].apply(null,n)})])))});return i.memo=e,i.unmemoized=n,i},C.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},C.times=L(C.map),C.timesSeries=L(C.mapSeries),C.timesLimit=function(n,t,e,r){return C.mapLimit(l(n),t,e,r)},C.seq=function(){var t=arguments;return m(function(e){var r=this,i=e[e.length-1];"function"==typeof i?e.pop():i=n,C.reduce(t,e,function(n,t,e){t.apply(r,n.concat([m(function(n,t){e(n,t)})]))},function(n,t){i.apply(r,[n].concat(t))})})},C.compose=function(){return C.seq.apply(null,Array.prototype.reverse.call(arguments))},C.applyEach=_(C.eachOf),C.applyEachSeries=_(C.eachOfSeries),C.forever=function(t,e){function r(n){if(n)return o(n);u(r)}var o=i(e||n),u=A(t);r()},C.ensureAsync=A,C.constant=m(function(n){var t=[null].concat(n);return function(n){return n.apply(this,t)}}),C.wrapSync=C.asyncify=function n(t){return m(function(n){var e=n.pop(),r;try{r=t.apply(this,n)}catch(n){return e(n)}e(null,r)})},"undefined"!=typeof module&&module.exports?module.exports=C:"undefined"!=typeof define&&define.amd?define([],function(){return C}):z.async=C}();var DEBUG=!1,context={},conversationPos,chatWrapper=jQuery(".bot-chat-wrapper");